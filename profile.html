<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="header.css">
  <link rel="stylesheet" href="notification.css">
  <link rel="stylesheet" href="dashboard-profile.css">
  <link rel="stylesheet" href="profile.css">
  <title>My Profile - CrossFire NCR</title>
</head>
<body>
  <header>
    <nav>
      <div class="navbar">
        <div>
          <a href="dashboard.html">
            <img src="images/crossfire-logo-transparent.png" alt="Crossfire Logo" class="logo">
          </a>
        </div>
        <div class="navbar-links">
          <ul>
            <li><a href="dashboard.html"><i class="bi bi-house-fill"></i> Dashboard</a></li>
            <li><a href="view-ncr.html"><i class="bi bi-file-earmark-bar-graph-fill"></i> NCR Log</a></li>
            <li id="create-ncr-menu"><a href="create-ncr.html"><i class="bi bi-file-earmark-plus-fill"></i> Create NCR</a></li>
            <li id="admin-panel"><a href="admin.html"><i class="bi bi-person-fill"></i>Admin Panel</a></li>
          </ul>
        </div>
        <div class="navbar-icons">
          <div onclick="closePopUp()" title="Notifications" class="navbar-notification">
            <i id="notification-icon" class="bi bi-bell-fill"></i>
            <div id="notification-indicator" class="notification-indicator">4</div>
          </div>
          
          <div class="navbar-profile" onclick="toggleProfileMenu()" title="Profile">
            <div class="profile-avatar">
              <i class="bi bi-person-fill"></i>
            </div>
            <span id="userName">User</span>
            <i class="bi bi-chevron-down profile-arrow"></i>
          </div>

          <div onclick="toggleMenu()" title="Menu" class="navbar-menu">
            <i id="menu-icon" class="bi bi-list"></i>
          </div>
          
          <div id="profilePopup" class="profile-popup hidden">
            <div class="profile-header">
              <div class="profile-avatar-large">
                <i class="bi bi-person-fill"></i>
              </div>
              <div class="profile-info">
                <h4 id="profileName">User Name</h4>
                <p id="profileDepartment">Department</p>
              </div>
            </div>
            <div class="profile-menu">
              <a href="profile.html" class="profile-menu-item">
                <i class="bi bi-person"></i> My Profile
              </a>
              <a href="#" class="profile-menu-item">
                <i class="bi bi-gear"></i> Settings
              </a>
              <hr class="profile-divider">
              <a href="index.html" class="profile-menu-item" onclick="logout()">
                <i class="bi bi-box-arrow-right"></i> Logout
              </a>
            </div>
          </div>
        </div>
        
        <div id="notificationPopup" title="Notifications" class="notification-popup hidden">
          <div>
            <h3 class="notification-title">Notifications</h3>
            <p id="no-notifications" class="no-notifications">No notifications yet</p>
            <ul class="notification-list"></ul>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <main>
    <div id="wrapper">
      <div class="profile-container">
        <!-- Profile Header -->
        <div class="profile-page-header">
          <div class="profile-avatar-huge">
            <i class="bi bi-person-fill"></i>
          </div>
          <div class="profile-header-info">
            <h1 style="display: flex;" id="profileFullName">Loading...</h1>
            <p id="profileRole">Department</p>
          </div>
        </div>

        <!-- Profile Details Card -->
        <div class="profile-card">
          <div class="profile-card-header">
            <h2><i class="bi bi-person-badge"></i> Personal Information</h2>
          </div>
          <div class="profile-details">
            
            <!-- First Name Row -->
            <div class="detail-row">
              <div class="detail-label">
                <i class="bi bi-person"></i>
                <span>First Name</span>
              </div>
              <!-- VIEW MODE -->
              <div class="detail-value view-mode" id="detailFirstName">-</div>
              <!-- EDIT MODE (hidden by default) -->
              <div class="detail-edit edit-mode" style="display: none;">
                <input type="text" id="editFirstName" class="edit-input" placeholder="First Name">
                <span class="error-message" id="firstNameError">First name is required</span>
              </div>
            </div>

            <!-- Last Name Row -->
            <div class="detail-row">
              <div class="detail-label">
                <i class="bi bi-person"></i>
                <span>Last Name</span>
              </div>
              <div class="detail-value view-mode" id="detailLastName">-</div>
              <div class="detail-edit edit-mode" style="display: none;">
                <input type="text" id="editLastName" class="edit-input" placeholder="Last Name">
                <span class="error-message" id="lastNameError">Last name is required</span>
              </div>
            </div>

            <!-- Email Row -->
            <div class="detail-row">
              <div class="detail-label">
                <i class="bi bi-envelope"></i>
                <span>Email</span>
              </div>
              <div class="detail-value view-mode" id="detailEmail">-</div>
              <div class="detail-edit edit-mode" style="display: none;">
                <input type="email" id="editEmail" class="edit-input" placeholder="email@example.com">
                <span class="error-message" id="emailError">Please enter a valid email</span>
              </div>
            </div>

            <!-- Non-editable fields (always in view mode) -->
            <div class="detail-row">
              <div class="detail-label">
                <i class="bi bi-building"></i>
                <span>Department</span>
              </div>
              <div class="detail-value" id="detailDepartment">-</div>
            </div>

            <div class="detail-row">
              <div class="detail-label">
                <i class="bi bi-person-badge"></i>
                <span>Username</span>
              </div>
              <div class="detail-value" id="detailUsername">-</div>
            </div>

            <div class="detail-row">
              <div class="detail-label">
                <i class="bi bi-hash"></i>
                <span>User ID</span>
              </div>
              <div class="detail-value" id="detailUserId">-</div>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="profile-actions">
          <!-- VIEW MODE BUTTONS -->
          <div id="viewModeButtons">
            <button class="btn-secondary" onclick="goBack()">
              <i class="bi bi-arrow-left"></i> Back to Dashboard
            </button>
            <button class="btn-primary" onclick="enterEditMode()">
              <i class="bi bi-pencil"></i> Edit Profile
            </button>
          </div>

          <!-- EDIT MODE BUTTONS (hidden by default) -->
          <div id="editModeButtons" style="display: none;">
            <button class="btn-secondary" onclick="cancelEdit()">
              <i class="bi bi-x-circle"></i> Cancel
            </button>
            <button class="btn-primary" onclick="saveProfile()">
              <i class="bi bi-check-circle"></i> Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer>&copy; Tech Thunders 2025</footer>
  <div id="toastContainer" class="toast-container"></div>

 <!-- 1. Data systems first -->
<script src="scripts/data-manager.js"></script>
<script src="scripts/user-manager.js"></script>

<!-- 2. Shared navbar (depends on UserManager) -->
<script src="scripts/navbar.js"></script>

<!-- 3. Other shared utilities -->
<script src="scripts/script.js"></script>
<script src="scripts/notifications.js"></script>
<script src="scripts/user-conditions.js"></script>

<!-- 4. Page-specific last -->
<script src="scripts/profile.js"></script>  <!-- or dashboard.js, ncr-form.js, etc. -->
</body>
</html>